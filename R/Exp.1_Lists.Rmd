---
title: "Experiment 1 List Design"
author: "Rachel"
date: /today
geometry: margin = 2cm
header-includes:
  - /usepackage{booktabs}
  - /usepackage{siunitx}
  - /usepackage{tabto}
  - /usepackage{soul}
  - /usepackage{xcolor}
  - /usepackage{placeins}
  - /usepackage{lscape}
  - /usepackage{animate}
  - /newcommand{/blandscape}{/begin{landscape}}
  - /newcommand{/elandscape}{/end{landscape}}
  - /makeatletter/renewcommand{/fps@table}{!ht}/makeatother
  - /setstcolor{red}
  - /usepackage{sectsty}
  - /sectionfont{/color{blue}} 
  - /subsectionfont{/color{blue}}
  - /subsubsectionfont{/color{darkgray}}

output:
  pdf_document: 
    fig_caption: yes
    fig_width: 7
    keep_tex: yes
    latex_engine: xelatex
    number_sections: yes
    toc: yes
    toc_depth: 4
  fontsize: 10pt
editor_options: 
  chunk_output_type: inline
---   
***
# Housekeeping   
The purpose of this file is to create the lists for Experiment 1.
*Color file here: http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf*
*crtl + I for reformat*  

## Knitting    
```{r Knitting, include=F}

library(knitr)

opts_chunk$set(
  dev = 'pdf',
  comment = "", 
  echo = FALSE, 
  warning = TRUE, 
  message = TRUE,
  cache = FALSE, 
  size = "small",
  tidy.opts = list(width.cutoff = 200),
  fig.width = 8, 
  fig.height = 4.5, 
  fig.align = "center")

def.chunk.hook  <- knitr::knit_hooks$get("chunk")

knitr::knit_hooks$set(
  chunk = function(x, options) {
    x <- def.chunk.hook(x, options)
    ifelse(
      options$size != "normalsize", 
      paste0(
        "/n //", 
        options$size,
        "/n/n", 
        x, 
        "/n/n //normalsize"), 
      x)
  })

color_block = function(color) {
  function(x, options)        sprintf('//color{%s}//begin{verbatim}%s//end{verbatim}//color{black}', color, x)
}
knitr::knit_hooks$set(error = color_block('red'))
knitr::knit_hooks$set(warning = color_block('orange'))
```

## Libraries   
```{r Library, include=F}
library(tidyverse)
library(magrittr)
library(broom)          # for extraction of coefficients
library(gganimate)      # to animate plots
library(RColorBrewer)   # to select brewer colors
library(kableExtra) 
library(lme4)
library(lmerTest)
library(ggpubr)
library(data.table)
```

```{r, include=F}
options(width = 110)
theme_set(theme_bw())
```

_____

# Lists  
## Exposure Phase    
### Critical Items     
```{r Ciritcal Items}
# Table with the information on how the stims should be paired: Materials x Accent x Gender x Ear Assignment

## Word list -> removes reliance on order

### Materials A
Materials.A_S.Words = c(  
  "Parasite",
  "Obscene",
  "Medicine",
  "Tennessee",
  "Peninsula",
  "Hallucinate",
  "Arkansas",
  "Compensate",
  "Dinosaur",
  "Rehearsal"
)

Materials.A_Sh.Words = c(
  "Ambition",
  "Machinery",
  "Brochure",
  "Official",
  "Crucial",
  "Pediatrician",
  "Flourishing",
  "Reassure",
  "Graduation",
  "Vacation"
)

## Materials B
Materials.B_S.Words = c(
  "Pregnancy",
  "Democracy",
  "Embassy",
  "Legacy",
  "Reconcile",
  "Personal",
  "Eraser",
  "Episode",
  "Literacy",
  "Coliseum"
)

Materials.B_Sh.Words= c(
  "Initial",
  "Beneficial",
  "Negotiate",
  "Commercial",
  "Parachute",
  "Efficient",
  "Publisher",
  "Glacier",
  "Refreshing",
  "Impatient"  
)

## Items
tibble(
  
  Phase = c(
  rep("Exposure", 20)
  ),

  Item.Type = c(
    rep("Critical", 20)
  ),
    
  Block = c(
    rep("1", 20)
  ),
  
  Item.Number = 1:20,

  Talker.A = c(
    Materials.A_Sh.Words, 
    Materials.B_S.Words
  ),
  
  Talker.A_Materials = c(
    rep("Materials A", 10),
    rep("Materials B", 10)
  ),
  
  Talker.A_Sound = c(
    rep("Sh", 10),
    rep("S", 10)
  ),
  
  Talker.B = c(
    Materials.A_S.Words, 
    Materials.B_Sh.Words
  ),
  
  Talker.B_Materials = c(
    rep("Materials B", 10),
    rep("Materials A", 10)
  ),
  
  Talker.B_Sound = c(
    rep("S", 10),
    rep("Sh", 10)
  )
) %>% 
  
  ## Possible Assignments (Shift x Gender x Ear)
  ### Which Talker is Attended to is dependent on instructions
  crossing(
    Version = c(
      "Shifted",
      "Unshifted"
    ),    
    Talker.A_Gender = c(
      "Female", 
      "Male"
    ),
    Talker.A_Ear = c(
      "Left", 
      "Right"
    )
  ) %>%
  
  ## Adds in column noting Gender + Ear Assignment for Talker B
  mutate(
    Talker.B_Gender =
      case_when( 
        Talker.A_Gender == "Female"
        ~ "Male", 
        T ~ "Female"
      )) %>%
  
  mutate(
    Talker.B_Ear =
      case_when(
        Talker.A_Ear == "Left"
        ~ "Right",
        T ~ "Left"
      )) %>%
  
  ## Talker 1 
  mutate(
    Talker = 
      case_when(
        Talker.A_Ear == "Left"
        ~ "1",
        T ~ "2"
      )
  ) %>%
  
  ## List
  mutate(
    List = 
      case_when(
        
        ### 01
        Talker.A_Materials == "Materials A" &
          Version == "Unshifted" &
          Talker.A_Gender == "Female" &
          Talker.A_Ear == "Left"
        ~ "01",
        
        Talker.A_Materials == "Materials B" &
          Version == "Shifted" &
          Talker.A_Gender == "Female"  &
          Talker.A_Ear == "Left"
        ~ "01",
        
        ### 02 
        Talker.A_Materials == "Materials B" &
          Version == "Unshifted" &
          Talker.A_Gender == "Female" &
          Talker.A_Ear == "Left"
        ~ "02",
        
        Talker.A_Materials == "Materials A" &
          Version == "Shifted" &
          Talker.A_Gender == "Female"  &
          Talker.A_Ear == "Left"
        ~ "02",
        
        ### 03 
        Talker.A_Materials == "Materials A" &
          Version == "Unshifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Right"
        ~ "03",
        
        Talker.A_Materials == "Materials B" &
          Version == "Shifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Right"
        ~ "03",
        
        ### 04    
        Talker.A_Materials == "Materials B" &
          Version == "Unshifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Right"
        ~ "04",
        
        Talker.A_Materials == "Materials A" &
          Version == "Shifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Right"
        ~ "04",  
        
        ### 05 
        Talker.A_Materials == "Materials A" &
          Version == "Unshifted" &
          Talker.A_Gender == "Female" &
          Talker.A_Ear == "Right"
        ~ "05",
        
        Talker.A_Materials == "Materials B" &
          Version == "Shifted" &
          Talker.A_Gender == "Female" &
          Talker.A_Ear == "Right"
        ~ "05",
        
        ### 06  
        Talker.A_Materials == "Materials B" &
          Version == "Unshifted" &
          Talker.A_Gender == "Female" &
          Talker.A_Ear == "Right"
        ~ "06",
        
        Talker.A_Materials == "Materials A" &
          Version == "Shifted" &
          Talker.A_Gender == "Female"  &
          Talker.A_Ear == "Right"
        ~ "06",
        
        ### 07    
        Talker.A_Materials == "Materials A" &
          Version == "Unshifted" &
          Talker.A_Gender == "Male" &
          Talker.A_Ear == "Left"
        ~ "07",
        
        Talker.A_Materials == "Materials B" &
          Version == "Shifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Left"
        ~ "07",
        
        ### 08
        Talker.A_Materials == "Materials B" &
          Version == "Unshifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Left"
        ~ "08",
        
        Talker.A_Materials == "Materials A" &
          Version == "Shifted" &
          Talker.A_Gender == "Male"  &
          Talker.A_Ear == "Left"
        ~ "08",
        
      )
  ) %>%
  
  ## Talker A 
  mutate(
    A = 
      paste0(
        
        ### Shift
        case_when(
          Version == "Shifted" 
          ~ paste0("As"),
          Version == "Unshifted" 
          ~ paste0("S")
        ),
        
        ### Sound
        case_when(
          Talker.A_Sound == "S"
          ~ paste0("", sep = "."),
          Talker.A_Sound == "Sh"
          ~ paste0("h", sep = ".")
        ),
        
        ### Talker A Word 
        paste0(Talker.A),
        
        ### Gender Assignment
        case_when(
          Talker.A_Gender == "Female" 
          ~ paste0(sep = ".", "F"), 
          T ~ paste0(sep = ".", "M")
        ),
        
        ### Ear Assignment
        case_when(
          Talker.A_Ear == "Left" 
          ~ paste0(sep = ".", "L"), 
          T ~ paste0(sep = ".", "R")
        )
        
      )) %>%
  view() %>%
  
  ## Talker B
  mutate(
    B = 
      paste0(
        
        ### Shift
        case_when(
          Version == "Shifted" 
          ~ paste0("As"),
          Version == "Unshifted" 
          ~ paste0("S")
        ),
        
        ### Sound
        case_when(
          Talker.B_Sound == "S"
          ~ paste0("", sep = "."),
          Talker.B_Sound == "Sh"
          ~ paste0("h", sep = ".")
        ),
        
        ### Talker B Word
        paste0(Talker.B),
        
        ### Gender Assignment
        case_when(
          Talker.B_Gender == "Female" 
          ~ paste0(sep = ".", "F"), 
          T ~ paste0(sep = ".", "M")
        ),
        
        ### Ear Assignment
        case_when(
          Talker.A_Ear == "Left" 
          ~ paste0(sep = ".", "R"), 
          T ~ paste0(sep = ".", "L")
        )
      )) %>%
  view() %>%
  
  # repetition of File within List
  mutate(
    reps = 1
  ) %>%
  
  # feedback
  mutate(
    feedback = FALSE
  ) %>%
  
  # Changing file names
  mutate(
    filename = 
      paste0(
        "Critical", 
        sep = "_",
        
        ## Order
        case_when(
          Talker == "1"
          ~ paste0(A, sep = "_", B),
          T ~ paste0(B, sep = "_", A)
        ),
        
        ## file suffix  
        paste0(".wav")   
      )) %>% 
  
  view() %>%
  
  # CSV Files
  
  ## Remove all columns but file names
  select(-c(A, B, Talker))  %>%
  
  ## Group files
  group_by(List) %>%
  
  group_map(.f = ~ write_csv(.x, file = paste0("C:Stimuli/Experiment_1/Lists/Critical.",  .y$List, ".csv")))
```


### Filler Items   
```{r Filler Items}

# Word List
Set.A_Word = c(
  "America",
  "Blueberry",
  "Camera",
  "Directory",
  "Dynamite",
  "Gardenia",
  "Hamburger",
  "Hurdle",
  "Inhabit",
  "Keyboard",
  "Lengthen",
  "Lingering",
  "Melancholy",
  "Napkin",
  "Ornament",
  "Pineapple",
  "Purgatory",
  "Therapeutic",
  "Tutorial",
  "Wealthy"
)

Set.B_Word = c(
  "Bakery",
  "Bullying",
  "Continually",
  "Document",
  "Eighty",
  "Grammatical",
  "Identical",
  "Interior",
  "Knowingly",
  "Lethal",
  "Lobbying",
  "Membrane",
  "Negate",
  "Outnumber",
  "Parakeet",
  "Platonic",
  "Tactical",
  "Titanium",
  "Umbrella",
  "Worldly"
)

Set.C_Word = c(
  "Ballerina",
  "Burglary",
  "Domineering",
  "Embody",
  "Gullible",
  "Honeymoon",
  "Illuminate",
  "Ironic",
  "Laminate",
  "Liability",
  "Marina",
  "Metrical",
  "Nightmare",
  "Panicking",
  "Pilgrim",
  "Predict",
  "Terminal",
  "Turbulent",
  "Undermine",
  "Wrinkle"
)

Set.A_NonWord = c(
  "Wominid",
  "Ungelnin",
  "Tilegkalo",
  "Rimkeluwar",
  "Rakil",
  "Perkum",
  "Nomerae",
  "Namuary",
  "Logelai", 
  "Lenediaw", 
  "Kelabidel",
  "Inpaki",
  "Hintarber",
  "Gardimuallay",
  "Gairelom",
  "Bikanian",
  "Baliber",
  "Amalar",
  "Ailounam",
  "Acomining"
)

Set.B_Nonword = c(
  "Wojalto",
  "Tounamplem",
  "Ryligal",
  "Rawamtee",
  "Ploupelai",
  "Omperoge",
  "Nempring",
  "Mibgem", 
  "Meidnow",
  "Kermimer",
  "Itempider",
  "Aknid",
  "Ibirak",
  "Halken",
  "Ganla",
  "Dadigal",
  "Bamtell",
  "Anemer",
  "Lilgrai",
  "Admunker"
)

Set.C_Nonword = c(
  "Youmgel",
  "Tymolape",
  "Tamical",
  "Rengime",
  "Pourilar",
  "Almikquary",
  "Niritaly",
  "Makid",
  "Kaldemia",
  "Imdalier",
  "Kloumidiger",
  "Halomimoc",
  "Gerbualo",
  "Galliwinou",
  "Emhoutic",
  "Dilkuaund",
  "Bowidai",
  "Anolipa",
  "Alnadiro",
  "Aigi"
)

# Table
tibble(

  Phase = c(
   rep("Exposure", 60) 
  ),
  
  Item.Type = c(
    rep("Filler", 60)
  ),
  
  Block = c(
    rep("1", 60)
  ),  
  
  Item.Number = c(
    rep(1:20,3) 
  ),
  
  Talker.A = c(
    Set.A_Word,
    Set.B_Word,
    Set.C_Word
  ),
  
   Talker.A_Materials = c(
    rep("Set A", 20),
    rep("Set B", 20),
    rep("Set C", 20)
  ),  
  
  Talker.A_Sound = c(
    rep("Word", 60)
  ),
  
  Talker.B = c(
    Set.A_NonWord,
    Set.B_Nonword,
    Set.C_Nonword
  ),
  
    Talker.B_Materials = c(
    rep("Set A", 20),
    rep("Set B", 20),
    rep("Set C", 20)
  ),
  
  Talker.B_Sound = c(
    rep("Nonword", 60)
  )
) %>%
  
  crossing(
    Talker.A_Gender = c(
      "Female", 
      "Male"
    ),
    Talker.A_Ear = c(
      "Left", 
      "Right"
    )
    ) %>%
  
  ## Adds in column noting Gender + Ear Assignment for Talker B
  mutate(
    Talker.B_Gender =
      case_when( 
        Talker.A_Gender == "Female"
        ~ "Male", 
        T ~ "Female"
      )
    ) %>%
  
  mutate(
    Talker.B_Ear =
      case_when(
        Talker.A_Ear == "Left"
        ~ "Right",
        T ~ "Left"
      )
    ) %>%
  
  ## Adds Version
  mutate(
    Version =
      case_when( 
        Talker.A_Gender == "Male" &
          Talker.A_Ear == "Left" 
        ~ "01",        
        
        Talker.A_Gender == "Female" &
          Talker.A_Ear == "Left"
        ~ "02", 
        
        Talker.A_Gender == "Female" &
          Talker.A_Ear == "Right" 
        ~ "03",
        
        Talker.A_Gender == "Male" &
          Talker.A_Ear == "Right"
        ~ "04", 
      )
    ) %>%
  
  ## Adds Combo
  mutate(
    Set.Combo =
      case_when( 
        
        ## Set A    
        Talker.A_Materials == "Set A" &
          Version == "03"
        ~ "1", 
        
        Talker.A_Materials == "Set A" &
          Version == "01"
        ~ "2",
        
        Talker.A_Materials == "Set A" &
          Version == "02"
        ~ "3",
        
        Talker.A_Materials == "Set A" &
          Version == "04"
        ~ "4",
        
        ## Set B    
        Talker.A_Materials == "Set B" &
          Version == "04"
        ~ "1", 
        
        Talker.A_Materials == "Set B" &
          Version == "02"
        ~ "2",
        
        Talker.A_Materials == "Set B" &
          Version == "01"
        ~ "3",
        
        Talker.A_Materials == "Set B" &
          Version == "03"
        ~ "4",
        
        ## Set C    
        Talker.A_Materials == "Set C" &
          Version == "01"
        ~ "1", 
        
        Talker.A_Materials == "Set C" &
          Version == "03"
        ~ "2",
        
        Talker.A_Materials == "Set C" &
          Version == "04"
        ~ "3",
        
        Talker.A_Materials == "Set C" &
          Version == "02"
        ~ "4"
      )
    ) %>%
  
  ## Critical Pairing
  mutate(
    Critical.Pair = 
      case_when(
        Set.Combo == "1" |
          Set.Combo == "4"
        ~ "X",
        T ~ "Y"
      )
  ) %>%
  
  ## Adds Attended Talker
  
  ### Attended Gender
  mutate( 
    Attended.Talker = 
      case_when(
        Set.Combo == "1" |
          Set.Combo == "3"
        ~ "Female",
        T ~ "Male"
      )
  ) %>%
  
  ### Attended Ear
  mutate( 
    Attended.Ear = 
      case_when(
        Set.Combo == "3" |
          Set.Combo == "4"
        ~ "Left",
        T ~ "Right"
      )
  ) %>%
  
  ## Talker A 
  mutate(
    A = 
      paste0(
        
        ### Talker A Sound
        paste0("W."),
        
        ### Talker A Word 
        paste0(Talker.A),
        
        ### Gender Assignment
        case_when(
          Talker.A_Gender == "Female" 
          ~ paste0(sep = ".", "F"), 
          T ~ paste0(sep = ".", "M")
        ),
        
        ### Ear Assignment
        case_when(
          Talker.A_Ear == "Left" 
          ~ paste0(sep = ".", "L"), 
          T ~ paste0(sep = ".", "R")
        )
        
      )
    ) %>%
  
  ## Talker B
  mutate(
    B = 
      paste0(
        
        ### Talker B Sound
        paste0("N."),

        ### Talker B Word
        paste0(Talker.B),
        
        ### Gender Assignment
        case_when(
          Talker.B_Gender == "Female" 
          ~ paste0(sep = ".", "F"), 
          T ~ paste0(sep = ".", "M")
        ),
        
        ### Ear Assignment
        case_when(
          Talker.B_Ear == "Right" 
          ~ paste0(sep = ".", "R"), 
          T ~ paste0(sep = ".", "L")
        )
      )
    ) %>%
  
  ## Talker 1 
  mutate(
    Talker = 
      case_when(
        Talker.A_Ear == "Left"
        ~ "1",
        T ~ "2"
      )
  ) %>%
  
  ## repetition of File within List
  mutate(
    reps = 1
  ) %>%
  
   # feedback
  mutate(
    feedback = FALSE
  ) %>%
  

# Changing file names
  mutate(
    filename = 
      paste0(
        "Critical", 
        sep = "_",
        
        ## Order
        case_when(
          Talker == "1"
          ~ paste0(A, sep = "_", B),
          T ~ paste0(B, sep = "_", A)
        ),
        
        ## file suffix  
        paste0(".wav")   
      )) %>% 
        
  view() %>%
  
  # CSV Files
  
  ## Remove columns in CSV File -> only need file names
  select(-c()) %>%
  
  ## Group         
  group_by(Set.Combo, Critical.Pair, Attended.Talker, Attended.Ear) %>%  
  
  group_map(.f = ~ write_csv(.x, file = paste0("C:Stimuli/Experiment_1/Lists/Filler.0", .y$Set.Combo,".csv")
  ))
```

## Test Phase  
### Test Items  
```{r Test Phase}
# Table
tibble(

  Phase = c(
  rep("Test", 6)
  ),
  
  Item.Type = c(
    rep("Test", 6)
  ),  
  
  Talker.A = c(
    "ashi.25",
    "ashi.30",
    "ashi.40",
    "ashi.45",
    "ashi.50",
    "ashi.70"
  ),

  Talker.B = c(
    rep("NA", 6)
  ),
  
  Item.Number = 1:6

)%>%
  
  ## Attended Talker x First Talker
  crossing(
    Talker.A_Gender = c(
      "Female", 
      "Male"
    ),
    
    Block = 1:12
  ) %>%
  
  ### Group every 2 blocks
  mutate(
    First_Talker = case_when( 
      abs(Block %% 4) == 1 &
        Talker.A_Gender == "Male"
      ~ "Male",
      
      abs(Block %% 4) == 2 &
        Talker.A_Gender == "Male"
      ~ "Male",
      
      abs(Block %% 4) == 3 &
        Talker.A_Gender == "Female"
      ~ "Male",      
      
      abs(Block %% 4) == 0 &
        Talker.A_Gender == "Female"
      ~ "Male",  
      
      abs(Block %% 4) == 1 &
        Talker.A_Gender == "Female"
      ~ "Female",
      
      abs(Block %% 4) == 2 &
        Talker.A_Gender == "Female"
      ~ "Female",
      
      abs(Block %% 4) == 3 &
        Talker.A_Gender == "Male"
      ~ "Female",
      
      abs(Block %% 4) == 0 &
        Talker.A_Gender == "Male"
      ~ "Female"
    ),
    
    ### 2 possible Lists: starting with the Female talker or the Male talker
    Test_Version = case_when(
      First_Talker == "Female"
      ~ "A",
      T ~ "B"
    )) %>%
  
  ### repetition of File within List
  mutate(
    reps = 1
  ) %>%
  
   # feedback
  mutate(
    feedback = FALSE
  ) %>%
  
  # File name
  mutate(
    filename = paste0(
      "Test",
      sep = "_",
      case_when(
        Talker.A_Gender == "Female"
        ~ paste0("F", sep = "."), 
        T ~ paste0("M", sep = ".")
      ),
      Item.Number,
      sep = "_",   
      Talker.A,
      paste0(".wav")
    )) %>%
  
  view() %>%
  
  # CSV Files
  
  ## Remove file columns <- all but file names
  select(-c(First_Talker)) %>%
  
  ## Group files into list 
  group_by(Test_Version) %>%
  
  group_map(.f = ~ write_csv(.x, file = paste0("C:Stimuli/Experiment_1/Lists/Test.", .y$Test_Version, ".csv")
  ))
```

```{r Attended Talker}
# Table

  tibble(
  Attended.Talker = c(
    rep("Female", 80),
    rep("NA", 72)
  ),
  
  Expected.Response = c(
    rep("Word", 20),
    
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
     "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword",
      "Word",
    "Nonword",
    "Nonword", 
      "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
       "Word",
    "Nonword",
    "Nonword",
    
    rep("NA", 72)
  )
  ) %>%
  
  write_csv(file = paste0("C:Stimuli/Experiment_1/Lists/Attend.Female.csv"))
```

# Concatenate CSV files  
```{r Concate}

# Origin
setwd("Stimuli/Experiment_1/Lists/")

# Destination
folder <- paste0("Stimuli/Experiment_1/Lists/Total/")

# Individual Lists
## Critical Lists 
C1 <- fread("Critical.01.csv")
C2 <- fread("Critical.02.csv")
C3 <- fread("Critical.03.csv")
C4 <- fread("Critical.04.csv")
C5 <- fread("Critical.05.csv")
C6 <- fread("Critical.06.csv")
C7 <- fread("Critical.07.csv")
C8 <- fread("Critical.08.csv")

## Filler Lists
F1 <- fread("Filler.01.csv")
F2 <- fread("Filler.02.csv")
F3 <- fread("Filler.03.csv")
F4 <- fread("Filler.04.csv")

## Test Lists
TA <- fread("Test.A.csv")
TB <- fread("Test.B.csv")

##Attended Talker + Expected Responses
AM <- fread("Attend.Male.csv")
AF <- fread("Attend.Female.csv")

# Total Lists
L01 <- rbind(C1, F2, TA, fill=TRUE) 
L02 <- rbind(C1, F2, TB, fill=TRUE)
L03 <- rbind(C1, F1, TA, fill=TRUE)
L04 <- rbind(C1, F1, TB, fill=TRUE)

L05 <- rbind(C2, F2, TA, fill=TRUE)
L06 <- rbind(C2, F2, TB, fill=TRUE)
L07 <- rbind(C2, F1, TA, fill=TRUE)
L08 <- rbind(C2, F1, TB, fill=TRUE)

L09 <- rbind(C3, F2, TA, fill=TRUE)
L10 <- rbind(C3, F2, TB, fill=TRUE)
L11 <- rbind(C3, F1, TA, fill=TRUE)
L12 <- rbind(C3, F1, TB, fill=TRUE)

L13 <- rbind(C4, F2, TA, fill=TRUE)
L14 <- rbind(C4, F2, TB, fill=TRUE)
L15 <- rbind(C4, F1, TA, fill=TRUE)
L16 <- rbind(C4, F1, TB, fill=TRUE)

L17 <- rbind(C5, F3, TA, fill=TRUE)
L18 <- rbind(C5, F3, TB, fill=TRUE)
L19 <- rbind(C5, F4, TA, fill=TRUE)
L20 <- rbind(C5, F4, TB, fill=TRUE)

L21 <- rbind(C6, F3, TA, fill=TRUE)
L22 <- rbind(C6, F3, TB, fill=TRUE)
L23 <- rbind(C6, F4, TA, fill=TRUE)
L24 <- rbind(C6, F4, TB, fill=TRUE)

L25 <- rbind(C7, F3, TA, fill=TRUE)
L26 <- rbind(C7, F3, TB, fill=TRUE)
L27 <- rbind(C7, F4, TA, fill=TRUE)
L28 <- rbind(C7, F4, TB, fill=TRUE)

L29 <- rbind(C8, F3, TA, fill=TRUE)
L30 <- rbind(C8, F3, TB, fill=TRUE)
L31 <- rbind(C8, F4, TA, fill=TRUE)
L32 <- rbind(C8, F4, TB, fill=TRUE)
### (There was probably a more efficient way to do this, possibly using the table I was trying to create)

# Attended Talker + Expected Response
L01M <- cbind(AM, L01) 
L02M <- cbind(AM, L02)
L03F <- cbind(AF, L03)
L04F <- cbind(AF, L04)

L05M <- cbind(AM, L05)
L06M <- cbind(AM, L06)
L07F <- cbind(AF, L07)
L08F <- cbind(AF, L08)

L09M <- cbind(AM, L09)
L10M <- cbind(AM, L10)
L11F <- cbind(AF, L11)
L12F <- cbind(AF, L12)

L13M <- cbind(AM, L13)
L14M <- cbind(AM, L14)
L15F <- cbind(AF, L15)
L16F <- cbind(AF, L16)

L17F <- cbind(AF, L17)
L18F <- cbind(AF, L18)
L19M <- cbind(AM, L19)
L20M <- cbind(AM, L20)

L21F <- cbind(AF, L21)
L22F <- cbind(AF, L22)
L23M <- cbind(AM, L23)
L24M <- cbind(AM, L24)

L25F <- cbind(AF, L25)
L26F <- cbind(AF, L26)
L27M <- cbind(AM, L27)
L28M <- cbind(AM, L28)

L29F <- cbind(AF, L29)
L30F <- cbind(AF, L30)
L31M <- cbind(AM, L31)
L32M <- cbind(AM, L32)


# Write CSV Files
write.csv(L01M, "List.01.csv")
write.csv(L02M, "List.02.csv")
write.csv(L03F, "List.03.csv")
write.csv(L04F, "List.04.csv")
write.csv(L05M, "List.05.csv")
write.csv(L06M, "List.06.csv")
write.csv(L07F, "List.07.csv")
write.csv(L08F, "List.08.csv")
write.csv(L09M, "List.09.csv")
write.csv(L10M, "List.10.csv")
write.csv(L11F, "List.11.csv")
write.csv(L12F, "List.12.csv")
write.csv(L13M, "List.13.csv")
write.csv(L14M, "List.14.csv")
write.csv(L15F, "List.15.csv")
write.csv(L16F, "List.16.csv")
write.csv(L17F, "List.17.csv")
write.csv(L18F, "List.18.csv")
write.csv(L19M, "List.19.csv")
write.csv(L20M, "List.20.csv")
write.csv(L21F, "List.21.csv")
write.csv(L22F, "List.22.csv")
write.csv(L23M, "List.23.csv")
write.csv(L24M, "List.24.csv")
write.csv(L25F, "List.25.csv")
write.csv(L26F, "List.26.csv")
write.csv(L27M, "List.27.csv")
write.csv(L28M, "List.28.csv")
write.csv(L29F, "List.29.csv")
write.csv(L30F, "List.30.csv")
write.csv(L31M, "List.31.csv")
write.csv(L32M, "List.32.csv")

# For Loop
#for(L in L01:L32){
#  write.csv( L, "List_", 01:32, ".csv" )
#}
### Trying to write a for loop below to write the csv files but one problem at a time
```

```{r Concate Table}
# Here we are generating the CSV files for each list. There are a total of *32* lists (described in Exp.1_Master file under writeups)

## How Lists are combined
tibble(
  Critical = c(
    'C1',
    'C2',
    'C3',
    'C4',
    'C5',
    'C6',
    'C7',
    'C8'
  )
) %>%
  
  crossing(
    if (
      Critical == 'C1'| 
      Critical == 'C2'|
      Critical == 'C3'|
      Critical == 'C4'
    ){
      Filler = c(
        'F2',
        'F3')
      
    } else {
      
      Filler = c(
        'F1',
        'F4')
    },
    ### Below I was trying to cross F2 & F3 with C1:C4, and F1 & F4 with C5:C8. The Filler List assignment is dependent on the Gender x Ear assignment in the Critical Lists!
    
    Test = c(
      'TA',
      'TB'
    )
  ) %>%
  view()
```


_______

# File Renaming

## Critical Items
```{r Critical Rename_S.F.L}
## Left: Female S Unambiguous; Right: Male Sh Unambiguous

Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/F.S_M.Sh/Nonambiguous/")


for (f in Files) {
  print(f)  
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/F.S_M.Sh/Nonambiguous/", 
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("F.S", "S", f.Category)
  f.left_Gender.Ear = gsub("_M.", ".F.L_", f.left_Shift)
  f.right_Shift = gsub("Sh", "Sh", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".M.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/1/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```


```{r Critical Rename_As.F.L}
## Left: Female S Ambiguous; Right: Male Sh Ambiguous

Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/F.S_M.Sh/Ambiguous/")

for (f in Files) {
  
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/F.S_M.Sh/Ambiguous/", 
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  
  f.left_Shift = gsub("F.Xs", "As", f.Category)
  f.left_Gender.Ear = gsub("_M.", ".F.L_", f.left_Shift)
  f.right_Shift = gsub("Xsh", "Ash", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".M.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/2/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

```{r Critical Rename_Sh.F.L}
## Left: Female Sh Unambiguous; Right: Male S Unambiguous
Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/F.Sh_M.S/Nonambiguous/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/F.Sh_M.S/Nonambiguous/", 
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("F.Sh", "Sh", f.Category)
  f.left_Gender.Ear = gsub("_M.", ".F.L_", f.left_Shift)
  f.right_Shift = gsub("_s", "_S", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".M.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/3/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

```{r Critical Rename_Ash.F.L}
## Left: Female Sh Ambiguous; Right: Male S Ambiguous
Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/F.Sh_M.S/Ambiguous/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/F.Sh_M.S/Ambiguous/", 
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("F.Xsh", "Ash", f.Category)
  f.left_Gender.Ear = gsub("_M.", ".F.L_", f.left_Shift)
  f.right_Shift = gsub("Xs", "As", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".M.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/4/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

```{r Critical Rename_S.M.L}
## Left: Male S Unambiguous; Right: Female Sh Unambiguous
Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/M.S_F.Sh/Nonambiguous/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/M.S_F.Sh/Nonambiguous/", 
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("M.S.", "S.", f.Category)
  f.left_Gender.Ear = gsub("_F.", ".M.L_", f.left_Shift)
  f.right_Shift = gsub("L_Sh.", "L_Sh.", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".F.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/5/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

```{r Critical Rename_As.M.L}
## Left: Male S Ambiguous; Right: Female Sh Ambiguous
Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/M.S_F.Sh/Ambiguous/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/M.S_F.Sh/Ambiguous/",
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("M.Xs", "As", f.Category)
  f.left_Gender.Ear = gsub("_F.", ".M.L_", f.left_Shift)
  f.right_Shift = gsub("Xsh", "Ash", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".F.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/6/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

```{r Critical Rename_Sh.M.L}
## Left: Male Sh Unambiguous; Right: Female S Unambiguous
Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/M.Sh_F.S/Nonambiguous/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/M.Sh_F.S/Nonambiguous/", 
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("M.Sh", "Sh", f.Category)
  f.left_Gender.Ear = gsub("_F.", ".M.L_", f.left_Shift)
  f.right_Shift = gsub("S", "S", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".F.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/7/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

```{r Critical Rename_Ash.M.L}
## Left: Male Sh Ambiguous; Right: Female S Ambiguous
Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/M.Sh_F.S/Ambiguous/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/M.Sh_F.S/Ambiguous/",
    f) 
  
  f.Category = gsub("^200ms", "Critical", f)
  f.left_Shift = gsub("M.Xsh", "Ash", f.Category)
  f.left_Gender.Ear = gsub("_F.", ".M.L_", f.left_Shift)
  f.right_Shift = gsub("Xs", "As", f.left_Gender.Ear)
  f.right_Gender.Ear = gsub(".wav", ".F.R.wav", f.right_Shift)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/8/", f.right_Gender.Ear)
  
  file.rename(old.files, new.files)
}
```

_____

```{r Critical List/Materials}

Files <- list.files(path = "Stimuli/Experiment_1/Items_Critical/8B/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Critical/8B/",
    f) 
  
  f.list = gsub("Critical", "Critical_08.X", f)
  f.materials = gsub(".X", ".B", f.list)
  
  new.files <- paste0("Stimuli/Experiment_1/Items_Critical/8/", f.materials)
  
  file.rename(old.files, new.files)
}
```
________

```{r Filler Rename}

Files <- list.files(path = "Stimuli/Experiment_1/Items_Filler/B/Version_2/")

for (f in Files) {
  
  old.files <- paste0(
    "Stimuli/Experiment_1/Items_Filler/B/Version_2/",
    f) 
  
  f.new = gsub("Filler_", "Filler_02_", f)
 
  new.files <- paste0("Stimuli/Experiment_1/Items_Filler/B/Version_2/", f.new)
  
  file.rename(old.files, new.files)
}
```
________