---
title: "Experiment 1 List Design"
author: "Rachel"
date: /today
geometry: margin = 2cm
header-includes:
  - /usepackage{booktabs}
  - /usepackage{siunitx}
  - /usepackage{tabto}
  - /usepackage{soul}
  - /usepackage{xcolor}
  - /usepackage{placeins}
  - /usepackage{lscape}
  - /usepackage{animate}
  - /newcommand{/blandscape}{/begin{landscape}}
  - /newcommand{/elandscape}{/end{landscape}}
  - /makeatletter/renewcommand{/fps@table}{!ht}/makeatother
  - /setstcolor{red}
  - /usepackage{sectsty}
  - /sectionfont{/color{blue}} 
  - /subsectionfont{/color{blue}}
  - /subsubsectionfont{/color{darkgray}}

output:
  pdf_document: 
    fig_caption: yes
    fig_width: 7
    keep_tex: yes
    latex_engine: xelatex
    number_sections: yes
    toc: yes
    toc_depth: 4
  fontsize: 10pt
editor_options: 
  chunk_output_type: inline
---   
***
# Housekeeping   
The purpose of this file is to create the lists for Experiment 1
*Color file here: http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf*   

## Knitting    
```{r Knitting, include=F}

library(knitr)

opts_chunk$set(
  dev = 'pdf',
  comment = "", 
  echo = FALSE, 
  warning = TRUE, 
  message = TRUE,
  cache = FALSE, 
  size = "small",
  tidy.opts = list(width.cutoff = 200),
  fig.width = 8, 
  fig.height = 4.5, 
  fig.align = "center")

def.chunk.hook  <- knitr::knit_hooks$get("chunk")

knitr::knit_hooks$set(
  chunk = function(x, options) {
    x <- def.chunk.hook(x, options)
    ifelse(
      options$size != "normalsize", 
      paste0(
        "/n //", 
        options$size,
        "/n/n", 
        x, 
        "/n/n //normalsize"), 
      x)
  })

color_block = function(color) {
  function(x, options)        sprintf('//color{%s}//begin{verbatim}%s//end{verbatim}//color{black}', color, x)
}
knitr::knit_hooks$set(error = color_block('red'))
knitr::knit_hooks$set(warning = color_block('orange'))
```

## Libraries   
```{r Library, include=F}
library(tidyverse)
library(magrittr)
library(broom)          # for extraction of coefficients
library(gganimate)      # to animate plots
library(RColorBrewer)   # to select brewer colors
library(kableExtra) 
library(lme4)
library(lmerTest)
library(ggpubr)
```

```{r, include=F}
options(width = 110)
theme_set(theme_bw())
```

# Exposure Phase   
## Critical Items     
```{r Ciritcal Items}
# Table with the information on how the stims should be paired: Materials x Accent x Gender x Ear Assignment

## Word list -> removes reliance on order

### Materials A
Materials.A_S.Words = c(  
  "Parasite",
  "Obscene",
  "Medicine",
  "Tennessee",
  "Penninsula",
  "Hallucinate",
  "Arkansas",
  "Compensate",
  "Dinosaur",
  "Rehearsal"
)

Materials.A_Sh.Words = c(
  "Ambition",
  "Machinery",
  "Brochure",
  "Official",
  "Crucial",
  "Pediatrician",
  "Flourishing",
  "Reassure",
  "Graduation",
  "Vacation"
)

## Materials B
Materials.B_S.Words = c(
  "Pregnancy",
  "Democracy",
  "Embassy",
  "Legacy",
  "Reconcile",
  "Personal",
  "Eraser",
  "Episode",
  "Literacy",
  "Coliseum"
)

Materials.B_Sh.Words= c(
  "Initial",
  "Beneficial",
  "Negotiate",
  "Commercial",
  "Parachute",
  "Efficient",
  "Publisher",
  "Glacier",
  "Refreshing",
  "Impatient"  
)

## Items
tibble(
  Critical_Item.Num = 1:20,
  Talker.A = c(Materials.A_Sh.Words, Materials.B_S.Words),
  Talker.B = c(Materials.A_S.Words, Materials.B_Sh.Words),
) %>% 
  
## Possible Assignments (Shift x Gender x Ear)
  ### Which Talker is Attended to is dependent on instructions
  crossing(
    Assignment_Shift = c(
      "Shifted (S)",
      "Unshifted (U)"
    ),    
    Assignment_Talker.A_Gender = c(
      "Female (F)", 
      "Male (M)"
    ),
    Assignment_Talker.A_Ear = c(
      "Left (L)", 
      "Right (R)"
    )
) %>%

## Adds in column noting Gender + Ear Assignment for Talker B
  mutate(
      Assignment_Talker.B_Gender =
        case_when( 
         Assignment_Talker.A_Gender == "Female (F)"
          ~ "Male (M)", 
          T ~ "Female (F)"
        )) %>%
 
 mutate(
    Assignment_Talker.B_Ear =
      case_when(
        Assignment_Talker.A_Ear == "Left (L)"
        ~ "Right (R)",
        T ~ "Left (L)"
      )) %>%

# Changing file names
  mutate(
    filename = 
      paste0(
        "Critical", 
        sep = "_",
        
  ## Talker A 
     
        ### Shift
        case_when(
          Assignment_Shift == "Shifted (S)" 
          ~ paste0("S", sep = "."),
          Assignment_Shift == "Unshifted (U)" 
          ~ paste0("U", sep = "."),
          ),
  
        ### Talker A Word 
        substr(Talker.A, 1, 5),
  
        ### Gender Assignment
        case_when(
          Assignment_Talker.A_Gender == "Female (F)" 
          ~ paste0(sep = ".", "F"), 
          T ~ paste0(sep = ".", "M")
        ),
          
        ### Ear Assignment
        case_when(
          Assignment_Talker.A_Ear == "Left (L)" 
          ~ paste0(sep = ".", "L"), 
          T ~ paste0(sep = ".", "R")
        ),
        
      sep = "_",
        
  ## Talker B
        
        ### Shift
        case_when(
          Assignment_Shift == "Shifted (S)" 
          ~ paste0("S", sep = "."),
          Assignment_Shift == "Unshifted (U)" 
          ~ paste0("U", sep = "."),
          ),
  
          ### Talker B Word
          substr(Talker.B, 1, 5),
  
          ### Gender Assignment
          case_when(
            Assignment_Talker.B_Gender == "Female (F)" 
            ~ paste0(sep = ".", "F"), 
            T ~ paste0(sep = ".", "M")
          ),
          
          ### Ear Assignment
          case_when(
            Assignment_Talker.B_Ear == "Left (L)" 
            ~ paste0(sep = ".", "L"), 
            T ~ paste0(sep = ".", "R")
          )
      )) %>% 

# CSV Files
group_by(Assignment_Shift, Assignment_Talker.A_Gender, Assignment_Talker.A_Ear) %>%
group_map(.f = ~ write_csv(.x, file = paste0("C:Stimuli/Experiment_1/Lists/Exposure_Phase/Critical_Lists/Critical_", .y$Assignment_Shift,"_Talker.A_", .y$Assignment_Talker.A_Gender, "_", .y$Assignment_Talker.A_Ear, ".csv")
))
```


## Key for File Names

Symbol | Meaning
------------------------------
 A.  | Attended Talker
 U.  | Unattended Talker
.M   | Male Gender
.F   | Female Gender
.L   | Left Ear
.R   | Right Ear    

Embed this table into table of who is the attended talker?

## Filler Items   
```{r Filler Items}

## Word List
Set.A_Word = c(
  "ameri",
  "blueb",
  "camer",
  "direc",
  "dynam",
  "garde",
  "hambu",
  "hurdl",
  "inhab",
  "keybo",
  "lengt",
  "linge",
  "melan",
  "napki",
  "ornam",
  "pinea",
  "purga",
  "thera",
  "tutor",
  "wealt"
)

Set.B_Word = c(
  "baker",
  "bully",
  "conti",
  "docum",
  "eight",
  "gramm",
  "ident",
  "inter",
  "knowi",
  "letha",
  "lobby",
  "membe",
  "negat",
  "outnu",
  "parak",
  "plato",
  "tacti",
  "titan",
  "umbre",
  "world"
)

Set.C_Word = c(
  "balle",
  "burgl",
  "domin",
  "embod",
  "gulli",
  "honey",
  "illum",
  "ironi",
  "lamin",
  "liabi",
  "marin",
  "metir",
  "night",
  "panic",
  "pilgr",
  "predi",
  "termi",
  "turbu",
  "under",
  "wink"
)

Set.A_NonWord = c(
  "womin",
  "ungel",
  "tileg",
  "rimke",
  "rakil",
  "perku",
  "nomer",
  "namue",
  "logel",
  "lened",
  "kelab",
  "inpak",
  "hinta",
  "gondi",
  "gaire",
  "bikan",
  "balib",
  "amala",
  "ailou",
  "acomi"
)

Set.B_Nonword = c(
  "woyal",
  "touna",
  "rylig",
  "rawam",
  "ploup",
  "omper",
  "nempr",
  "mibge",
  "meidn",
  "kermi",
  "itemp",
  "aknid",
  "ibira",
  "halke",
  "ganla",
  "dadig",
  "bamte",
  "aneme",
  "lilgr",
  "admun"
)

Set.C_Nonword = c(
  "youmg",
  "tymol",
  "tamic",
  "rengi",
  "pouri",
  "oumik",
  "nirit",
  "mikid",
  "kalde",
  "imdai",
  "kloum",
  "halom",
  "gerbu",
  "galli",
  "emhou",
  "dilku",
  "bawes",
  "anoli",
  "alnad",
  "aigi"
)

## Table
tibble(
  Set = c(
    rep("A", 20),
    rep("B", 20),
    rep("C", 20)
  ), 
  
  Filler_Item.Num = c(
    rep(1:20,3) 
  ),
  
  Talker.A_Word = c(
    Set.A_Word,
    Set.B_Word,
    Set.C_Word
  ),
  
  Talker.B_Nonword = c(
    Set.A_NonWord,
    Set.B_Nonword,
    Set.C_Nonword
  )
) %>%
  
  crossing(
    Assignment_Talker.A_Gender = c(
      "Female (F)", 
      "Male (M)"
    ),
    Assignment_Talker.A_Ear = c(
      "Left (L)", 
      "Right (R)"
    )) %>%
  
  ## Adds in column noting Gender + Ear Assignment for Talker B
  mutate(
      Assignment_Talker.B_Gender =
        case_when( 
         Assignment_Talker.A_Gender == "Female (F)"
          ~ "Male (M)", 
          T ~ "Female (F)"
        )) %>%
 
 mutate(
    Assignment_Talker.B_Ear =
      case_when(
        Assignment_Talker.A_Ear == "Left (L)"
        ~ "Right (R)",
        T ~ "Left (L)"
      )) %>%
  
  ## Adds Version
  mutate(
      Set.Version =
        case_when( 
           Assignment_Talker.A_Gender == "Female (F)" &
           Assignment_Talker.A_Ear == "Left (L)"
            ~ "1", 
          
           Assignment_Talker.A_Gender == "Female (F)" &
           Assignment_Talker.A_Ear == "Right (R)"
            ~ "2", 
           
           Assignment_Talker.A_Gender == "Male (M)" &
           Assignment_Talker.A_Ear == "Left (L)" 
            ~ "3", 
           
           Assignment_Talker.A_Gender == "Male (M)" &
           Assignment_Talker.A_Ear == "Right (R)" 
            ~ "4"
        )) %>%

# Changing file names
  mutate(
    filename = 
      paste0(
        "Filler", 
        sep = "_",
        
  ## Talker A 
     
        ### Word
          paste0("W", sep = "."),
  
        ### Talker A Word 
          paste0(Talker.A_Word),
          
        ### Gender Assignment
        case_when(
          Assignment_Talker.A_Gender == "Female (F)" 
          ~ paste0(sep = ".", "F"), 
          T ~ paste0(sep = ".", "M")
        ),
          
        ### Ear Assignment
        case_when(
          Assignment_Talker.A_Ear == "Left (L)" 
          ~ paste0(sep = ".", "L"), 
          T ~ paste0(sep = ".", "R")
        ),
        
      sep = "_",
        
  ## Talker B
        
        ### Nonword
        paste0("N", sep = "."),
  
        ### Talker B Word
        paste0(Talker.B_Nonword),
  
          ### Gender Assignment
          case_when(
            Assignment_Talker.B_Gender == "Female (F)" 
            ~ paste0(sep = ".", "F"), 
            T ~ paste0(sep = ".", "M")
          ),
          
          ### Ear Assignment
          case_when(
            Assignment_Talker.B_Ear == "Left (L)" 
            ~ paste0(sep = ".", "L"), 
            T ~ paste0(sep = ".", "R")
          )
      )) %>% 
  
# CSV Files
group_by(Set, Set.Version, Assignment_Talker.A_Gender, Assignment_Talker.A_Ear) %>%
group_map(.f = ~ write_csv(.x, file = paste0("C:Stimuli/Experiment_1/Lists/Exposure_Phase/Filler_Lists/Filler_Set.", .y$Set,"_V.", .y$Set.Version, "_Talker A_", .y$Assignment_Talker.A_Gender, "_", .y$Assignment_Talker.A_Ear, ".csv")
))
```

# Test Phase
```{r Test Phase}

## Table
tibble(
  Test_Item = c(
  "ashi.25",
  "ashi.30",
  "ashi.40",
  "ashi.45",
  "ashi.50",
  "ashi.70"
  ),
  
  Test_Item.Num = 1:6
)%>%

### Attended Talker x First Talker
crossing(
  Talker_Gender = c(
    "Female (F)", 
    "Male (M)"
    ),
  
  Block = 1:12
) %>%

### Group every 2 blocks
  mutate(
    First_Talker = case_when( 
      abs(Block %% 4) == 1 &
      Talker_Gender == "Male (M)"
      ~ "Male",
      
      abs(Block %% 4) == 2 &
      Talker_Gender == "Male (M)"
      ~ "Male",
      
      abs(Block %% 4) == 3 &
      Talker_Gender == "Female (F)"
      ~ "Male",      
            
      abs(Block %% 4) == 0 &
      Talker_Gender == "Female (F)"
      ~ "Male",  
      
      abs(Block %% 4) == 1 &
      Talker_Gender == "Female (F)"
      ~ "Female",
      
      abs(Block %% 4) == 2 &
      Talker_Gender == "Female (F)"
      ~ "Female",
      
      abs(Block %% 4) == 3 &
      Talker_Gender == "Male (M)"
      ~ "Female",
      
      abs(Block %% 4) == 0 &
      Talker_Gender == "Male (M)"
      ~ "Female"
      ),

### 2 possible Lists: starting with the Female talker or the Male talker
    Test_Version = case_when(
      First_Talker == "Female"
      ~ "A",
      T ~ "B"
    )) %>%
  
### File name
mutate(
 Filename = paste0(
   "Test",
   sep = "_",
   Test_Version,
   sep = ".",
   
   case_when(
     Block < 10
     ~ paste0("0", Block),
     T ~ paste0(Block)
   ),
   
   sep = "_",
      case_when(
     Talker_Gender == "Female (F)"
     ~ paste0("F", sep = "."), 
     T ~ paste0("M", sep = ".")
   ),
   Test_Item.Num,
   sep = ".",   
   Test_Item
)) %>%
  
# CSV Files
group_by(Test_Version, Block, Talker_Gender) %>%
group_map(.f = ~ write_csv(.x, file = paste0("C:Stimuli/Experiment_1/Lists/Test_Phase/Test.", .y$Test_Version,"_Block.", .y$Block, ".csv")
))
```

# File Renaming

## Critical Items
```{r Critical Rename}

## Left: Female S Unambiguous; Right: Male Sh Unambiguous
Critical.Item_F.S.L.U <- list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/F.S_M.Sh/F.S_M.Sh", pattern = ".wav", full.names = TRUE)

## Left: Female S Ambiguous; Right: Male Sh Ambiguous
Critical.Item_F.S.L.A <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/F.S_M.Sh/F.Xs_M.Xsh", pattern = ".wav", full.names = TRUE)

## Left: Female Sh Unambiguous; Right: Male S Unambiguous
Critical.Item_F.Sh.L.U <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/F.Sh_M.S/F.Sh_M.S", pattern = ".wav", full.names = TRUE)

## Left: Female Sh Ambiguous; Right: Male S Ambiguous
Critical.Item_F.Sh.A <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/F.Sh_M.S/F.Sh_M.S", pattern = ".wav", full.names = TRUE)

## Left: Male S Unambiguous; Right: Female Sh Unambiguous
Critical.Item_M.S.U <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/M.S_F.Sh/M.S_F.Sh", pattern = ".wav", full.names = TRUE)

## Left: Male S Ambiguous; Right: Female Sh Ambiguous
Critical.Item_M.S.A <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/M.S_F.Sh/M.Xs_F.Xsh", pattern = ".wav", full.names = TRUE)

## Left: Male Sh Unambiguous; Right: Female S Unambiguous
Critical.Item_M.Sh.U <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/M.Sh_F.S/M.Sh_F.S", pattern = ".wav", full.names = TRUE)

## Left: Male Sh Ambiguous; Right: Female S Ambiguous
Critical.Item_M.Sh.A <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Critical_Pairs/Stereo/M.Sh_F.S/M.Sh_F.S", pattern = ".wav", full.names = TRUE)
```

## Filler Items
```{r Filler Rename}

## Set A
### Version 1: Left = Female Nonword; Right = Male Word
Filler.Item_SA.V1 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/A/Version 1", pattern = ".wav", full.names = TRUE)

### Version 2: Left = Female Word; Right = Male Nonword
Filler.Item_SA.V2 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/A/Version 2", pattern = ".wav", full.names = TRUE)

### Version 3: Left = Male Nonword; Right = Female Word
Filler.Item_SA.V3 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/A/Version 3", pattern = ".wav", full.names = TRUE)
  
### Version 4: Left = Male Word; Right = Female Nonword
Filler.Item_SA.V4 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/A/Version 4", pattern = ".wav", full.names = TRUE)


## Set B
### Version 1: Left = Female Nonword; Right = Male Word
Filler.Item_SA.V1 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/B/Version 1", pattern = ".wav", full.names = TRUE)

### Version 2: Left = Female Word; Right = Male Nonword
Filler.Item_SA.V2 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/B/Version 2", pattern = ".wav", full.names = TRUE)

### Version 3: Left = Male Nonword; Right = Female Word
Filler.Item_SA.V3 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/B/Version 3", pattern = ".wav", full.names = TRUE)
  
### Version 4: Left = Male Word; Right = Female Nonword
Filler.Item_SA.V4 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/B/Version 4", pattern = ".wav", full.names = TRUE)


## Set C
### Version 1: Left = Female Nonword; Right = Male Word
Filler.Item_SA.V1 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/C/Version 1", pattern = ".wav", full.names = TRUE)

### Version 2: Left = Female Word; Right = Male Nonword
Filler.Item_SA.V2 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/C/Version 2", pattern = ".wav", full.names = TRUE)

### Version 3: Left = Male Nonword; Right = Female Word
Filler.Item_SA.V3 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/C/Version 3", pattern = ".wav", full.names = TRUE)
  
### Version 4: Left = Male Word; Right = Female Nonword
Filler.Item_SA.V4 <-
list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Filler_Pairs/Stereo/C/Version 4", pattern = ".wav", full.names = TRUE)

```

## Test Items
```{r Test Rename}

## Female Test Continuum
Test.Item_Female <- list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Test_Continuum/Original/Female", pattern = ".wav", full.names = TRUE)

## Male Test Continuum
Test.Item_Male <- list.files("C:/Users/Rachel/Documents/Social.Influence_Speech.Perception/SI.SP/Stimuli/Original_Stims/Test_Continuum/Original/Male", pattern = ".wav", full.names = TRUE)

```

# CSV File (Concat?)
```{r}
...%>%
select(-c(item, talker_gender)) %>%
group_by(talker_gender_first, block) %>%
group_map(.f = ~ write_csv(.x, file = paste0("temp/List-Test-FirstTalkerGender-", .y$talker_gender_first, "_Block-",
.y$block, ".csv")))
```
